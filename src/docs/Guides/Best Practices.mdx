import { Meta } from '@storybook/addon-docs/blocks';

<Meta title="Guides/Best Practices" />

<div style={{ textAlign: 'center', margin: '2rem 0 2.5rem 0' }}>
  <h1 style={{ fontWeight: 700, fontSize: '2.2rem', margin: '1rem 0 0.5rem 0' }}>Best Practices</h1>
  <p style={{ color: '#666', fontSize: '1.1rem', margin: 0 }}>
Comprehensive guide to best practices for using the Draupnir Design System effectively.
  </p>
</div>

## Component Usage

### ✅ Do: Use Design Tokens

```tsx
// ✅ Good - Using design tokens
import { colors, spacing, typography } from '@/tokens';

const Card = ({ children }) => (
  <div style={{
    backgroundColor: colors.background.light,
    padding: spacing.md,
    borderRadius: '8px',
    fontSize: typography.text.md,
    color: colors.text.primary,
  }}>
    {children}
  </div>
);

// ❌ Bad - Hard-coded values
const Card = ({ children }) => (
  <div style={{
    backgroundColor: '#FFFFFF',
    padding: '24px',
    borderRadius: '8px',
    fontSize: '16px',
    color: '#212121',
  }}>
    {children}
  </div>
);
```

### ✅ Do: Follow Atomic Design Principles

```tsx
// ✅ Good - Composing from atoms
import { Button } from '@/components/atoms/Button';
import { Badge } from '@/components/atoms/Badge';
import { Box } from '@/components/atoms/Box';

const UserCard = ({ user }) => (
  <Box>
    <Avatar size="md" image={user.avatar} description={user.name} />
    <Typography size="lg">{user.name}</Typography>
    <Badge variant="success">{user.status}</Badge>
    <Button variant="primary">View Profile</Button>
  </Box>
);

// ❌ Bad - Creating custom components without reusing atoms
const UserCard = ({ user }) => (
  <div className="custom-user-card">
    <img src={user.avatar} alt={user.name} />
    <h3>{user.name}</h3>
    <span className="status-badge">{user.status}</span>
    <button className="custom-button">View Profile</button>
  </div>
);
```

## Accessibility

### ✅ Do: Provide Proper ARIA Labels

```tsx
// ✅ Good - Descriptive aria-labels
import { Button } from '@/components/atoms/Button';

const DeleteButton = ({ onDelete, itemName }) => (
  <Button 
    variant="danger"
    aria-label={`Delete ${itemName}`}
    onClick={onDelete}
  >
    Delete
  </Button>
);

// ❌ Bad - No context for screen readers
const DeleteButton = ({ onDelete }) => (
  <Button variant="danger" onClick={onDelete}>
    Delete
  </Button>
);
```

### ✅ Do: Use Semantic HTML

```tsx
// ✅ Good - Semantic structure
import { TitlePage } from '@/components/organisms/TitlePage';
import { Typography } from '@/components/atoms/Typography';

const Dashboard = () => (
  <main>
    <TitlePage 
      title="Dashboard" 
      description="Overview of your account"
    />
    <section aria-labelledby="recent-activity">
      <Typography size="lg" id="recent-activity">
        Recent Activity
      </Typography>
      {/* Content */}
    </section>
  </main>
);

// ❌ Bad - Non-semantic structure
const Dashboard = () => (
  <div>
    <div className="title">Dashboard</div>
    <div className="section">
      <div className="heading">Recent Activity</div>
      {/* Content */}
    </div>
  </div>
);
```

## Color Usage

### ✅ Do: Use Semantic Colors Appropriately

```tsx
// ✅ Good - Semantic color usage
import { Badge } from '@/components/atoms/Badge';
import { Notice } from '@/components/molecules/Notice';

const StatusIndicator = ({ status }) => {
  const getStatusConfig = (status) => {
    switch (status) {
      case 'active':
        return { variant: 'success', message: 'Account is active' };
      case 'pending':
        return { variant: 'warning', message: 'Account is pending review' };
      case 'suspended':
        return { variant: 'error', message: 'Account is suspended' };
      default:
        return { variant: 'info', message: 'Status unknown' };
    }
  };

  const config = getStatusConfig(status);
  
  return (
    <div>
      <Badge variant={config.variant}>{status}</Badge>
      <Notice type={config.variant} message={config.message} />
    </div>
  );
};

// ❌ Bad - Inconsistent color usage
const StatusIndicator = ({ status }) => (
  <div>
    <span className={`status-${status}`}>{status}</span>
    <div className={`message-${status}`}>
      {status === 'active' ? 'Good' : 'Bad'}
    </div>
  </div>
);
```

### ✅ Do: Ensure Color Contrast

```tsx
// ✅ Good - High contrast combinations
import { colors } from '@/tokens';

const HighContrastButton = () => (
  <Button 
    style={{
      backgroundColor: colors.primary[500], // #FFD600
      color: colors.text.primary, // #212121 - High contrast
    }}
  >
    Primary Action
  </Button>
);

// ❌ Bad - Low contrast
const LowContrastButton = () => (
  <Button 
    style={{
      backgroundColor: colors.primary[500], // #FFD600
      color: '#FFFFFF', // Low contrast on yellow
    }}
  >
    Primary Action
  </Button>
);
```

## Typography

### ✅ Do: Use Consistent Text Hierarchy

```tsx
// ✅ Good - Proper text hierarchy
import { Typography } from '@/components/atoms/Typography';

const Article = ({ title, subtitle, content }) => (
  <article>
    <Typography size="4xl" variant="primary">
      {title}
    </Typography>
    <Typography size="lg" variant="secondary">
      {subtitle}
    </Typography>
    <Typography size="md">
      {content}
    </Typography>
  </article>
);

// ❌ Bad - Inconsistent sizing
const Article = ({ title, subtitle, content }) => (
  <article>
    <h1 style={{ fontSize: '32px' }}>{title}</h1>
    <h2 style={{ fontSize: '18px' }}>{subtitle}</h2>
    <p style={{ fontSize: '14px' }}>{content}</p>
  </article>
);
```

## Spacing

### ✅ Do: Use Consistent Spacing

```tsx
// ✅ Good - Using spacing tokens
import { spacing } from '@/tokens';
import { Box } from '@/components/atoms/Box';

const Layout = ({ children }) => (
  <Box style={{ padding: spacing.lg }}>
    <Box style={{ marginBottom: spacing.md }}>
      {children}
    </Box>
  </Box>
);

// ❌ Bad - Inconsistent spacing
const Layout = ({ children }) => (
  <div style={{ padding: '32px' }}>
    <div style={{ marginBottom: '16px' }}>
      {children}
    </div>
  </div>
);
```

## Form Design

### ✅ Do: Provide Clear Labels and Feedback

```tsx
// ✅ Good - Accessible form design
import { Input } from '@/components/molecules/Input';
import { Notice } from '@/components/molecules/Notice';

const ContactForm = () => {
  const [email, setEmail] = useState('');
  const [error, setError] = useState('');

  const validateEmail = (email) => {
    if (!email.includes('@')) {
      setError('Please enter a valid email address');
      return false;
    }
    setError('');
    return true;
  };

  return (
    <form>
      <Input.Root label="Email Address" error={error}>
        <Input.Control
          type="email"
          value={email}
          onChange={(e) => setEmail(e.target.value)}
          onBlur={() => validateEmail(email)}
          placeholder="Enter your email"
          aria-describedby={error ? "email-error" : undefined}
        />
      </Input.Root>
      {error && (
        <Notice 
          type="error" 
          message={error}
          id="email-error"
        />
      )}
    </form>
  );
};

// ❌ Bad - Poor form design
const ContactForm = () => (
  <form>
    <input 
      type="email" 
      placeholder="Email"
      style={{ border: '1px solid #ccc' }}
    />
  </form>
);
```

## Responsive Design

### ✅ Do: Design for All Screen Sizes

```tsx
// ✅ Good - Responsive component
import { Box } from '@/components/atoms/Box';
import { spacing } from '@/tokens';

const ResponsiveCard = ({ children }) => (
  <Box 
    style={{
      padding: spacing.md,
      maxWidth: '100%',
      width: '100%',
      '@media (min-width: 768px)': {
        maxWidth: '600px',
        margin: '0 auto',
      },
      '@media (min-width: 1024px)': {
        maxWidth: '800px',
      },
    }}
  >
    {children}
  </Box>
);

// ❌ Bad - Fixed width
const FixedCard = ({ children }) => (
  <div style={{ width: '600px', padding: '24px' }}>
    {children}
  </div>
);
```

## Performance

### ✅ Do: Optimize Component Rendering

```tsx
// ✅ Good - Memoized component
import React, { memo } from 'react';
import { Button } from '@/components/atoms/Button';

const ActionButton = memo(({ onClick, children, variant = 'primary' }) => (
  <Button variant={variant} onClick={onClick}>
    {children}
  </Button>
));

// ✅ Good - Stable callbacks
const Dashboard = () => {
  const handleSave = useCallback(() => {
    // Save logic
  }, []);

  const handleDelete = useCallback((id) => {
    // Delete logic
  }, []);

  return (
    <div>
      <ActionButton onClick={handleSave}>Save</ActionButton>
      <ActionButton onClick={() => handleDelete(1)} variant="danger">
        Delete
      </ActionButton>
    </div>
  );
};

// ❌ Bad - Unstable callbacks
const Dashboard = () => (
  <div>
    <ActionButton onClick={() => console.log('save')}>
      Save
    </ActionButton>
  </div>
);
```

## Testing

### ✅ Do: Write Meaningful Tests

```tsx
// ✅ Good - Comprehensive testing
import { render, screen, fireEvent } from '@testing-library/react';
import { Button } from '@/components/atoms/Button';

describe('Button', () => {
  it('renders with correct text', () => {
    render(<Button>Click me</Button>);
    expect(screen.getByRole('button')).toHaveTextContent('Click me');
  });

  it('calls onClick when clicked', () => {
    const handleClick = jest.fn();
    render(<Button onClick={handleClick}>Click me</Button>);
    
    fireEvent.click(screen.getByRole('button'));
    expect(handleClick).toHaveBeenCalledTimes(1);
  });

  it('is disabled when disabled prop is true', () => {
    render(<Button disabled>Click me</Button>);
    expect(screen.getByRole('button')).toBeDisabled();
  });

  it('has correct aria-label for accessibility', () => {
    render(<Button aria-label="Save document">Save</Button>);
    expect(screen.getByRole('button')).toHaveAttribute('aria-label', 'Save document');
  });
});

// ❌ Bad - Insufficient testing
describe('Button', () => {
  it('renders', () => {
    render(<Button>Click me</Button>);
    // No assertions
  });
});
```

## Error Handling

### ✅ Do: Provide User-Friendly Error States

```tsx
// ✅ Good - Graceful error handling
import { Notice } from '@/components/molecules/Notice';
import { Loading } from '@/components/molecules/Loading';

const DataComponent = () => {
  const [data, setData] = useState(null);
  const [loading, setLoading] = useState(true);
  const [error, setError] = useState(null);

  useEffect(() => {
    fetchData()
      .then(setData)
      .catch(setError)
      .finally(() => setLoading(false));
  }, []);

  if (loading) return <Loading />;
  
  if (error) {
    return (
      <Notice 
        type="error" 
        message="Unable to load data. Please try again later."
      />
    );
  }

  return <div>{/* Render data */}</div>;
};

// ❌ Bad - Poor error handling
const DataComponent = () => {
  const [data, setData] = useState(null);

  useEffect(() => {
    fetchData().then(setData);
  }, []);

  return <div>{data}</div>; // Will crash if data is null
};
```

## Documentation

### ✅ Do: Document Component Usage

```tsx
// ✅ Good - Well-documented component
/**
 * UserCard displays user information in a card format
 * 
 * @param {Object} user - User object
 * @param {string} user.name - User's full name
 * @param {string} user.email - User's email address
 * @param {string} user.avatar - URL to user's avatar image
 * @param {string} user.status - User's account status
 * @param {Function} onEdit - Callback when edit button is clicked
 * @param {Function} onDelete - Callback when delete button is clicked
 * 
 * @example
 * ```tsx
 * <UserCard
 *   user={{
 *     name: "John Doe",
 *     email: "john@example.com",
 *     avatar: "/avatars/john.jpg",
 *     status: "active"
 *   }}
 *   onEdit={() => console.log('Edit user')}
 *   onDelete={() => console.log('Delete user')}
 * />
 * ```
 */
const UserCard = ({ user, onEdit, onDelete }) => (
  <Box>
    <Avatar size="md" image={user.avatar} description={user.name} />
    <Typography size="lg">{user.name}</Typography>
    <Typography size="sm" variant="secondary">{user.email}</Typography>
    <Badge variant="success">{user.status}</Badge>
    <div>
      <Button variant="primary" onClick={onEdit}>Edit</Button>
      <Button variant="danger" onClick={onDelete}>Delete</Button>
    </div>
  </Box>
);

// ❌ Bad - Undocumented component
const UserCard = ({ user, onEdit, onDelete }) => (
  <div>
    <img src={user.avatar} />
    <h3>{user.name}</h3>
    <p>{user.email}</p>
    <span>{user.status}</span>
    <button onClick={onEdit}>Edit</button>
    <button onClick={onDelete}>Delete</button>
  </div>
);
```

## Summary

Following these best practices will help you:

- ✅ **Build consistent interfaces** across your application
- ✅ **Ensure accessibility** for all users
- ✅ **Improve maintainability** with reusable components
- ✅ **Enhance performance** with optimized rendering
- ✅ **Create better user experiences** with proper error handling
- ✅ **Facilitate collaboration** with clear documentation

Remember: The Draupnir Design System is designed to make your development process more efficient and your applications more accessible. Use these guidelines as a foundation and adapt them to your specific needs while maintaining consistency with the design system principles. 